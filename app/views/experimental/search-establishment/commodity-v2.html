{% extends "layout.html" %}

{% block pageTitle %}
Home â€“ GOV.UK Prototype Kit
{% endblock %}
{% block beforeContent %}
{{super()}}
<a href="javascript:history.back()" class="govuk-back-link">Back</a>
{% endblock%}
{% block content %}

{% if query.copy == "yes"%}
<div class="govuk-grid-row" data-v-0c6ff6a7="">
  <div class="govuk-grid-column-two-thirds">
    <div class="govuk-notification-banner govuk-notification-banner--success" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
      <div class="govuk-notification-banner__header">
        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
          Success
        </h2>
      </div>
      <div class="govuk-notification-banner__content">
        <!-- <h3 class="govuk-notification-banner__heading">
          Coppied commodity
        </h3> -->
        <p class="govuk-body">Commodity coppied</p>
      </div>
    </div>
  </div>
</div>
{% endif %}
<div class="govuk-grid-row" data-v-0c6ff6a7="">
  <div class="govuk-grid-column-full">
    {% set ehc = 0 %}
    {% set ccode =   0 %}
    {% set cert = data.certificates[ehc]%}
    <span class="govuk-caption-xl">{{ data.certificates[ehc].number or "test" }}</span>
    <h1 class="govuk-heading-xl">Add commodity data</h1>
    <form method="post">
      <input type="hidden" name="ehc" value="{{data.certificates[ehc].number}}">
      <input type="hidden" name="commodity_id" value="{{ccode}}">
      <input type="hidden" name="commodity_code" value="{{data.certificates[ehc].commodities[ccode].code}}">
      <input type="hidden" name="commodity_description" value="{{data.certificates[ehc].commodities[ccode].title}}">
      <div class="commodity-pane--body open" style="" id="commodity-details-panel">
        <div class="govuk-grid-row">
          <div class="govuk-grid-column-two-thirds">
            <div class="identification-questions">
              <section id="intro">
                <h2 class="govuk-heading-s govuk-!-margin-bottom-2">Commodity</h2>
                <p><span class="govuk-tag">{{data.certificates[ehc].commodities[ccode].code}}</span> {{data.certificates[ehc].commodities[ccode].title}}
                <p>
              </section>
              <section id="questions">
                <div class="govuk-form-group"><label class="govuk-label" for="PRODUCT_DESCRIPTION-0-10410-31010000">Product description &nbsp;(Optional) </label>
                  <input class="govuk-input" type="text" id="description" name="description" value="{% if query.change or query.copy %}{{data.addedCommodities[query.id].description}}{% endif %}">
                </div>
                {% if cert.batchNumber %}
                <div class="govuk-form-group"><label class="govuk-label" for="BATCH_NUMBER-1-11711-020130">Batch number</label><input class="govuk-input" type="text" name="batchNumber" id="BATCH_NUMBER-1-11711-020130"></div>
                {% endif %}


                <label class="govuk-label" >Manufacturing plant</label>
                {% if data.has_manufacturing_plant != "yes" %}
                <div class="govuk-form-group app-find-establishment-card">
                  {% set url = "start" %}
                  {% if query.has_saved_orgs == "no" %}
                  {% set url = "results" %}
                  {% endif %}
                  <p class="govuk-!-margin-bottom-0"><a href="./find-v2/{{url}}?searchLabel=manufacturing plant&searchReturnURL=../commodity-v2">Select a manufacturing plant</a></p>

                </div>
                {% else %}
                {% set org = data.establishments[query.id or 0] %}
                <div class="govuk-form-group app-find-establishment-card">
                  <h3 class="govuk-heading-s govuk-!-margin-bottom-0">{{org.TradingName}} ({{org.AppNo}})</h3>
                  <p class="govuk-!-margin-bottom-0">{{org.Address1}},{% if org.Address2 !="" %} {{org.Address2}},{%endif%} {{org.Town}}, {{org.Postcode}}, {{org.Country}}<br>
                    <a href="./find-v2/start?id={{query.id}}&change=yes&searchLabel=manufacturing plant&searchActivity=Mince Meat Establishment">Select a different manufacturing plant</a></p>
                </div>
                {% endif %}
                {% if query.showAdditionalPlants %}
                <div class="govuk-form-group app-find-establishment-card">
                  <p class="govuk-!-margin-bottom-0"><a href="./find-v2/start?searchLabel=manufacturing plant&searchReturnURL=../commodity-v2">Select another manufacturing plant</a></p>
                  <input type="hidden" name="manufaturingPlant_name" value="">
                  <input type="hidden" name="manufaturingPlant_address" value="">
                </div>
                {% endif %}

                {% if cert.coldStore %}
                {% set searchLabel = "Cold store"%}
                {% block searchColdStore %}{% include "./components/_search_establishment.html" %}{% endblock %}
                {% endif %}

                {% if cert.dateOfCollection %}
                <div class="govuk-form-group"><label class="govuk-label" for="COLLECTION_PRODUCTION_DATE-3-11711-020120">Date of collection/production
                    <!---->
                  </label>
                  <!---->
                  <!---->
                  <!----><input class="govuk-input" type="datetime-local" name="COLLECTION_PRODUCTION_DATE" id="COLLECTION_PRODUCTION_DATE-3-11711-020120">
                  <!---->
                  <!---->
                </div>
                {% endif %}

                {% if cert.cuttingPlant %}
                {% set searchLabel = "Cutting plant"%}
                {% block searchcuttingPlant %}{% include "./components/_search_establishment.html" %}{% endblock %}
                {% endif %}

                {% if cert.dateOfFreezing %}
                <div class="govuk-form-group app-repeadable-holder">
                  <label class="govuk-label" for="FREEZING_DATE-6-11711-020120">Date of freezing &nbsp;(Optional) </label>
                  <!---->
                  <!---->
                  <!---->
                  <!---->
                  <div class="app-repeatable-section" id="repeatable-freezing-date">
                    <div class="govuk-input__wrapper m-t-15">
                      <input name="dateOfFreezing" class="govuk-input" type="datetime-local" id="FREEZING_DATE-6-11711-020120">
                      <div class="govuk-input__suffix suffix__action" aria-hidden="true">
                        <button class="govuk-button govuk-button--secondary add-repeatable-section" id="repeatable-add-freezing-date" data-target="repeatable-freezing-date" data-count="0"><span class="fas fa-plus"></span></button>
                      </div>
                    </div>
                  </div>
                </div>
                {% endif %}

                {% if cert.identificationMark %}
                <div class="govuk-form-group"><label class="govuk-label" for="IDENTIFICATION_MARK-7-11711-020120">Identification mark
                    <!---->
                  </label>
                  <!---->
                  <!---->
                  <!----><input class="govuk-input" type="text" name="identificationMark" id="IDENTIFICATION_MARK-7-11711-020120">
                </div>
                {% endif %}
                {% if cert.natureOfCommodity and (cert.natureOfCommodity | length) > 0 %}
                {% block natureOfCommodity %}{% include "./components/_nature-of-commodity.html" %}{% endblock %}
                {% endif %}

                <div class="govuk-form-group">
                  <label class="govuk-label" for="NET_WEIGHT-3-10410-31010000">Net weight</label>
                  <div class="govuk-input__wrapper select-input-wrapper" data-v-4e8f37a8="">
                    <input class="govuk-input" type="number" data-type="quantity" name="NET_WEIGHT" step="0.01" min="0" max="9999999" id="NET_WEIGHT-3-10410-31010000"
                      value="{% if query.change or query.copy %}{{data.addedCommodities[query.id].NET_WEIGHT}}{% endif %}">
                    <div class="govuk-input__suffix suffix__action" data-v-4e8f37a8="">
                      <select class="govuk-select" id="NET_WEIGHT-3-10410-31010000-units" name="NET_WEIGHT_quatifier" data-v-4e8f37a8="">
                        <option disabled="" value="" data-v-4e8f37a8="" selected>Select a unit</option>
                        <option value="gram" {% if data.addedCommodities[query.id].NET_WEIGHT_quatifier == 'gram'%}selected{% endif %}>gram</option>
                        <option value="kilogram" {% if data.addedCommodities[query.id].NET_WEIGHT_quatifier == 'kilogram'%}selected{% endif %}>kilogram</option>
                        <option value="kilotonne" {% if data.addedCommodities[query.id].NET_WEIGHT_quatifier == 'kilotonne'%}selected{% endif %}>kilotonne</option>
                        <option value="tonne (metric ton)" {% if data.addedCommodities[query.id].NET_WEIGHT_quatifier == 'tonne (metric ton)'%}selected{% endif %}>tonne (metric ton)</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="govuk-form-group"><label class="govuk-label" for="PACKAGE_COUNT-4-10410-31010000">Package count
                  </label>
                  <div class="govuk-input__wrapper select-input-wrapper" data-v-4e8f37a8=""><input class="govuk-input" type="number" data-type="quantity" name="PACKAGE_COUNT" step="1" min="0" max="9999999" id="PACKAGE_COUNT-4-10410-31010000"
                      data-v-4e8f37a8="" data-mask="########" data-mask-inited="true" data-mask-raw-value="" {% if data.addedCommodities[query.id].PACKAGE_COUNT %}value="{{data.addedCommodities[query.id].PACKAGE_COUNT}}" {% endif %}>
                    <div class="govuk-input__suffix suffix__action" data-v-4e8f37a8="">
                      <select class="govuk-select" id="PACKAGE_COUNT-4-10410-31010000-units" data-v-4e8f37a8="" name="PACKAGE_COUNT_quatifier">
                        <option disabled="" value="" data-v-4e8f37a8="" selected>Select a unit</option>
                        <option value="Bag" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Bag'%}selected{% endif %}>Bag</option>
                        <option value="Bale, compressed" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Bale, compressed'%}selected{% endif %}>Bale, compressed</option>
                        <option value="Barrel, wooden, bung type" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Barrel, wooden, bung type'%}selected{% endif %}>Barrel, wooden, bung type</option>
                        <option value="Barrel, wooden, removable head" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Barrel, wooden, removable head'%}selected{% endif %}>Barrel, wooden, removable head</option>
                        <option value="Box" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Box'%}selected{% endif %}>Box</option>
                        <option value="Box, wooden, natural wood, ordinary" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Box, wooden, natural wood, ordinary'%}selected{% endif %}>Box, wooden, natural wood, ordinary</option>
                        <option value="Box, wooden, natural wood, with sift proof walls" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Box, wooden, natural wood, with sift proof walls'%}selected{% endif %}>Box, wooden, natural
                          wood,
                          with sift proof walls</option>
                        <option value="Bulk, solid, granular particles ('grains')" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == "Bulk, solid, granular particles ('grains')"%}selected{% endif %}>Bulk, solid, granular particles
                          ("grains")
                        </option>
                        <option value="Can, rectangular" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Can, rectangular'%}selected{% endif %}>Can, rectangular</option>
                        <option value="Canister" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Canister'%}selected{% endif %}>Canister</option>
                        <option value="Carton" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Carton'%}selected{% endif %}>Carton</option>
                        <option value="Case" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Case'%}selected{% endif %}>Case</option>
                        <option value="Case, with pallet base, wooden" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Case, with pallet base, wooden'%}selected{% endif %}>Case, with pallet base, wooden</option>
                        <option value="Cask" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Cask'%}selected{% endif %}>Cask</option>
                        <option value="Coffer" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Coffer'%}selected{% endif %}>Coffer</option>
                        <option value="Container, not otherwise specified as transport equipment" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Container, not otherwise specified as transport equipment'%}selected{% endif %}>
                          Container,
                          not otherwise specified as transport equipment</option>
                        <option value="Crate" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Crate'%}selected{% endif %}>Crate</option>
                        <option value="Crate, wooden" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Crate, wooden'%}selected{% endif %}>Crate, wooden</option>
                        <option value="Drum" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Drum'%}selected{% endif %}>Drum</option>
                        <option value="Receptacle, glass" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Receptacle, glass'%}selected{% endif %}>Receptacle, glass</option>
                        <option value="Jar" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Jar'%}selected{% endif %}>Jar</option>
                        <option value="Logs, in bundle/bunch/truss" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Logs, in bundle/bunch/truss'%}selected{% endif %}>Logs, in bundle/bunch/truss</option>
                        <option value="Lug" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Lug'%}selected{% endif %}>Lug</option>
                        <option value="Luggage" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Luggage'%}selected{% endif %}>Luggage</option>
                        <option value="Package" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Package'%}selected{% endif %}>Package</option>
                        <option value="Package, display, wooden" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Package, display, wooden'%}selected{% endif %}>Package, display, wooden</option>
                        <option value="Pail" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Pail'%}selected{% endif %}>Pail</option>
                        <option value="Pallet" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Pallet'%}selected{% endif %}>Pallet</option>
                        <option value="Bag, plastics film" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Bag, plastics film'%}selected{% endif %}>Bag, plastics film</option>
                        <option value="Box, plastic, expanded" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Box, plastic, expanded'%}selected{% endif %}>Box, plastic, expanded</option>
                        <option value="Punnet" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Punnet'%}selected{% endif %}>Punnet</option>
                        <option value="Rednet" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Rednet'%}selected{% endif %}>Rednet</option>
                        <option value="Tank, rectangula" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Tank, rectangula'%}selected{% endif %}>Tank, rectangular</option>
                        <option value="Bag, tote" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Bag, tote'%}selected{% endif %}>Bag, tote</option>
                        <option value="Tray pack" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Tray pack'%}selected{% endif %}>Tray pack</option>
                        <option value="Tube" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Tube'%}selected{% endif %}>Tube</option>
                        <option value="Vial" {% if data.addedCommodities[query.id].PACKAGE_COUNT_quatifier == 'Vial'%}selected{% endif %}>Vial</option>
                      </select>
                    </div>
                  </div>
                </div>


                {% if cert["Plant / Establishment / Centre"]%}
                {% set searchLabel = "Plant / Establishment / Centre"%}
                {% block searchplant %}{% include "./components/_search_establishment.html" %}{% endblock %}
                {% endif %}

                {% if cert.Slaughterhouse %}
                {% set searchLabel = "Slaughter house"%}
                {% block searchSlaughterhouse %}{% include "./components/_search_establishment.html" %}{% endblock %}
                {% endif %}


                {% block species %}{% include "./components/_species.html" %}{% endblock %}

                {% if cert.treatmentType %}
                {% block treatmentType %}{% include "./components/_treatment-type.html" %}{% endblock %}
                {% endif %}



                {% if manufacturingPlant%}
                <div class="govuk-form-group">
                  <label class="govuk-label" for="Premises of Origin-5-10367-4101">Premises of Origin</label>
                  <input class="govuk-input" type="text" id="Premises of Origin-5-10367-4101" name="premises_of_origin" value="{% if query.change=='yes' or query.copy%}{{data.addedCommodities[query.id].premises_of_origin}}{% endif %}">
                </div>
                {% endif %}
                <!---->
                <section id="actions">
                  <button data-module="govuk-button" type="submit" name="submit-button" class="govuk-button m-r-5" id="addIdentification">{% if query.change == "yes" %}Update{% else %}Add{% endif %} commodity</button>

                </section>
            </div>
            <!---->
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
</div>
{% endblock %}
{% block pageScripts %}
<script type="text/javascript">
  window.addEventListener('load', function() {

    $('.add-repeatable-section').on('click', function(e) {
      e.preventDefault()
      var count = $(this).attr("data-count")
      var targetID = "#" + $(this).attr('data-target')
      var section = $(targetID).html()
      console.log(section)
      var blockID = $(section).attr("id") + count
      var deleteButton = '<button class="govuk-button govuk-button--secondary"><span class="fas fa-trash-alt"></span></button>'
      var button = $(section).find(".add-repeatable-section")
      console.log(button)
      // var formID = section.find("input").attr("id")+count
      $(section).attr("id", blockID)
      var s = $('.app-repeadable-holder').append(section)
    })
  })
</script>
{% endblock%}
