<!-- This is dynamicaly generated by the array in /app/data/certs.json -->
{% if cert.species | length == 0 %}
{% set listOfSpecies = cert.commodities[commodityID].species %}
{% else %}
{% set listOfSpecies = cert.species %}
{% endif %}

<!-- crude check to see if we have an array or a string -->
{% if (identification.species | length) == 2 %}
  {% set defaultValue = identification.species[0] %}
{% else %}
  {% set defaultValue = identification.species %}
{% endif %}

<div class="govuk-form-group"><label class="govuk-label" for="TAXON">Species
  </label><select class="govuk-select govuk-!-width-two-thirds" id="TAXON" name="species">

      <option disabled="" value="" {% if not (data.change or data.copy) %}selected{%endif%}>{% if (listOfSpecies| length) <= 10%}Select a taxonomy{% endif %}</option>

    {% if (listOfSpecies| length) > 0%}
    {% for species in listOfSpecies%}
    <option value="{{species}}" {% if (data.change or data.copy) and (species == identification.species) %}selected{%endif%}>{{species}}</option>
    {% endfor %}]
    {% else %}
    <option value="not set">Not set any species in JSON</option>
    {% endif %}
  </select>
  <input type="hidden" value="{% if data.change or data.copy %}{{identification.species}}{%endif%}" name="defaultValue" id="defaultValue">
</div>
{% if (listOfSpecies| length) > 10 %}
<script type="text/javascript" src="/public/javascripts/accessible-autocomplete.min.js"></script>
<script type="text/javascript">
  window.addEventListener('load', function() {
    id = 'autocomplete-autoselect';
    element = document.querySelector('#TAXON')
    accessibleAutocomplete.enhanceSelectElement({
        selectElement: element,
        showAllValues: true,
        dropdownArrow: () => '',
        autoselect: false,
        defaultValue: document.querySelector("#defaultValue").value || ''
      })
    // accessibleAutocomplete.enhanceSelectElement({
    //   selectElement: element,
    //   name : "species",
    //   showAllValues: true,
    //   autoselect: false,
    //   defaultValue: document.querySelector("#defaultValue").value || ''
    // })
    // If you want a chevron dropdown:

    // dropdownArrow: function (config) {
    //   return '<svg class="autocomplete__dropdown-arrow-down" style="top: 12px;" viewBox="0 0 512 512" ><path d="M256,298.3L256,298.3L256,298.3l174.2-167.2c4.3-4.2,11.4-4.1,15.8,0.2l30.6,29.9c4.4,4.3,4.5,11.3,0.2,15.5L264.1,380.9  c-2.2,2.2-5.2,3.2-8.1,3c-3,0.1-5.9-0.9-8.1-3L35.2,176.7c-4.3-4.2-4.2-11.2,0.2-15.5L66,131.3c4.4-4.3,11.5-4.4,15.8-0.2L256,298.3  z"/></svg>'
    // },
  })
</script>
{% endif %}
